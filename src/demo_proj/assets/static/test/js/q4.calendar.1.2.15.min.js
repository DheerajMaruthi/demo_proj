/*
Widget:   q4.calendar
Version:  1.2.15
Compiled: 2018-07-24
*/
!function(a){a.widget("q4.calendar",{options:{popupCls:".module-event-calendar_event-container",dateFormat:"MMMM D, YYYY",usePublic:!1,languageId:null,url:"",apiKey:"",eventSelection:3,showPastOnLoad:!1,news:!0,presentations:!0,financials:!0,slideshare:"",triggerEventsLoad:!1,defaultTag:"",eventTemplates:{location:'{{#location}}<div class="module_location"><span class="module_location-text">{{location}}</span></div>{{/location}}',speakers:'{{#speakers.length}}<div class="module_speakers"><h4>Speaker(s):</h4><ul>{{#speakers}}<li class="module_speaker"><i class="q4-icon_user-fill"></i> {{name}}, {{position}}</li> {{/speakers}}</ul></div>{{/speakers.length}}',webcast:'{{#webcast}}<div class="module_webcast"><a href="{{webcast}}" target="_blank" class="module_link module_webcast-link">Webcast <span class="sr-only">(opens in new window)</span></a></div>{{/webcast}}',news:'{{#pressReleases}}<div class="module_news"><a href="{{url}}" target="_blank" class="module_link module_news-link">Press Release <span class="sr-only">(opens in new window)</span></a></div>{{/pressReleases}}',docs:'{{#docs.length}}<ul class="module_attachments">{{#docs}}<li class="module_attachment"><a href="{{url}}" target="_blank" class="module_link module_attachment-link {{#type}}module_link-{{type}}{{/type}}">{{title}} <span class="sr-only">(opens in new window)</span></a></li>{{/docs}}</ul>{{/docs.length}}',presentations:'{{#presentations}}<div class="module_presentation"><a href="{{url}}" target="_blank" class="module_link module_presentation-link">Presentation <span class="sr-only">(opens in new window)</span></a></div>{{/presentations}}',financials:'{{#financialReports}}{{#docs.length}}<ul class="module_financials">{{#docs}}<li><a href="{{docUrl}}" target="_blank" class="module_link module_financial-link">{{docTitle}} <span class="sr-only">(opens in new window)</span></a></li>{{/docs}}</ul>{{/docs.length}}{{/financialReports}}',addToCal:'<div class="module_add-to-calendar"><span class="module_link module_add-to-calendar-reveal">Add to Calendar</span><ul class="module_add-to-calendar-list"><li class="module_add-to-calendar-item module_add-to-calendar-item--apple"><a href="/DownloadICal.aspx?id={{id}}" target="_blank" class="module_add-to-calendar-link"><i class="q4-icon_apple"></i><span class="module_add-to-calendar-text sr-only">Add to Apple Calendar</span></a></li><li class="module_add-to-calendar-item module_add-to-calendar-item--google"><a href="/DownloadICal.aspx?id={{id}}&amp;platform=GoogleCalendar" target="_blank" class="module_add-to-calendar-link"><i class="q4-icon_google"></i><span class="module_add-to-calendar-text sr-only">Add to Google Calendar</span></a></li><li class="module_add-to-calendar-item module_add-to-calendar-item--outlook"><a href="/DownloadICal.aspx?id={{id}}" target="_blank" class="module_add-to-calendar-link"><i class="q4-icon_microsoft"></i><span class="module_add-to-calendar-text sr-only">Add to Microsoft Outlook</span></a></li><li class="module_add-to-calendar-item module_add-to-calendar-item--ics"><a href="/DownloadICal.aspx?id={{id}}" target="_blank" class="module_add-to-calendar-link"><i class="q4-icon_calendar"></i><span class="module_add-to-calendar-text sr-only">Add to iCalendar</span></a></li></ul></div>',event:function(){return'{{#items}}<div class="module_item list--reset" data-cls="{{clndrDateCls}}"><div class="module_date-time"><span class="module_date-text">{{{date}}}</span></div><div class="module_headline"><a href="{{url}}" class="module_headline-link">{{title}}</a></div>'+this.location+this.speakers+'<div class="module_links module_q4-icon-links">{{#id}}'+this.addToCal+"{{/id}}"+this.webcast+this.presentations+this.news+this.docs+this.financials+"</div></div>{{/items}}"}},onEventsLoad:function(b,c,d){var e=[];d.defaultTag.length&&a.each(c,function(b,c){if(a.inArray(d.defaultTag,c.tag.split(" "))>-1)return void e.push(c.items)}),e.length||a.each(c.reverse(),function(a,b){var c=new Date((new Date).setHours(23,59,59,59));if(new Date(new Date(b.endDate).setHours(23,59,59,59))>c)return void e.push(b.items)}),!e.length&&d.showPastOnLoad&&c.length&&e.push(c.reverse()[0].items),e.length&&a(d.popupCls).html(Mustache.render(d.eventTemplates.event(),{items:[{date:moment(e[0].StartDate).format(d.dateFormat),time:"00:00:00"==e[0].StartDate.split(" ")[1]?"":moment(e[0].startDate).format("h:mm A"),timeZone:"0"==e[0].TimeZone?"":e[0].TimeZone,docs:a.map(e[0].Attachments,function(a){return{title:a.Title,url:a.Url,type:a.Type.toLowerCase(),extension:a.Extension,size:a.Size}}),id:new Date(e[0].StartDate)>new Date&&e[0].EventId,location:e[0].Location,pressReleases:a.map(e[0].EventPressRelease,function(a){return{title:a.Headline,url:a.LinkToDetailPage,docUrl:a.DocumentPath}}),presentations:a.map(e[0].EventPresentation,function(a){return{body:a.body,size:a.DocumentFileSize,type:a.DocumentFileType,url:a.DocumentPath,title:a.Title}}),speakers:a.map(e[0].EventSpeaker,function(a){return{name:a.SpeakerName,position:a.SpeakerPosition}}),title:e[0].Title,url:e[0].LinkToDetailPage,webcast:e[0].WebCastLink,financialReports:function(){if(e[0].EventFinancialReport[0]&&e[0].EventFinancialReport[0].Documents){var b=a.map(e[0].EventFinancialReport[0].Documents,function(a){return{docCategory:a.DocumentCategory,docSize:a.DocumentFileSize,docIcon:a.IconPath,docThumb:a.ThumbnailPath,docTitle:a.DocumentTitle,docType:a.DocumentFileType,docUrl:a.DocumentPath}});return{title:e[0].EventFinancialReport[0].ReportTitle,docs:b}}},tags:e[0].TagsList,clndrDateCls:"calendar-day-"+a.datepicker.formatDate("yy-mm-dd",new Date(e[0].StartDate))}]}));var f=a(".module-event-calendar_event-container .module_item");f.length&&a(".module-event-calendar_day").filter("."+f.data("cls")).addClass("module-event-calendar_day--selected"),void 0!==q4App&&void 0!==q4App.addToCalendar&&q4App.addToCalendar(d.popupCls+" .module_add-to-calendar")},onSlideShareLoad:function(a,b){},complete:function(a){},eventSize:25,tags:[],calendar:{multiDayEvents:{startDate:"startDate",endDate:"endDate"},render:function(a){return Mustache.render('<div class="module-event-calendar_controls"><div class="module-event-calendar_previous-month clndr-previous-button"><i class="q4-icon_chevron-left"></i></div><div class="module-event-calendar_month">{{month}} {{year}}</div><div class="module-event-calendar_next-month clndr-next-button"><i class="q4-icon_chevron-right"></i></div></div><div class="module-event-calendar_day-container grid--no-gutter">{{#daysOfTheWeek}}<div class="module-event-calendar_day module-event-calendar_day--name grid_col">{{.}}</div>{{/daysOfTheWeek}}{{#days}}<div class="{{classes}} grid_col"><span>{{day}}</span></div>{{/days}}</div>',a)},template:null,weekOffset:0,daysOfTheWeek:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],targets:{day:"module-event-calendar_day",empty:"module-event-calendar_day--empty",nextButton:"module-event-calendar_next-month",todayButton:"module-event-calendar_today",previousButton:"module-event-calendar_previous-month",nextYearButton:"module-event-calendar_next-year",previousYearButton:"module-event-calendar_previous-year"},classes:{past:"module-event-calendar_day--past",today:"module-event-calendar_day--today",event:"module-event-calendar_day--event",selected:"module-event-calendar_day--selected",inactive:"module-event-calendar_day--inactive",lastMonth:"module-event-calendar_day--last-month",nextMonth:"module-event-calendar_day--next-month",adjacentMonth:"module-event-calendar_day--adjacent-month"},showAdjacentMonths:!0,adjacentDaysChangeMonth:!1,ready:function(){a(".module-event-calendar_calendar-container").on("click",".module-event-calendar_day--event",function(){a(".module-event-calendar_calendar-container").find(".module-event-calendar_day--event").removeClass("module-event-calendar_day--selected"),a(this).addClass("module-event-calendar_day--selected")})},doneRendering:function(){},clickEvents:{click:function(b){var c={date:null,items:[]},d=a.q4.calendar._proto.options,e=b.element.className.split(" ");b.events.length&&(a.each(b.events,function(f,g){var h=g.items;c.items.push({date:moment(h.StartDate).format(d.dateFormat),time:"00:00:00"==h.StartDate.split(" ")[1]?"":moment(h.StartDate).format("h:mm A"),timeZone:"0"==h.TimeZone?"":h.TimeZone,docs:a.map(h.Attachments,function(a){return{title:a.Title,url:a.Url,type:a.Type.toLowerCase(),extension:a.Extension,size:a.Size}}),id:new Date(h.StartDate)>new Date&&h.EventId,location:h.Location,pressReleases:a.map(h.EventPressRelease,function(a){return{title:a.Headline,url:a.LinkToDetailPage,docUrl:a.DocumentPath}}),presentations:a.map(h.EventPresentation,function(a){return{body:a.body,size:a.DocumentFileSize,type:a.DocumentFileType,url:a.DocumentPath,title:a.Title}}),speakers:a.map(h.EventSpeaker,function(a){return{name:a.SpeakerName,position:a.SpeakerPosition}}),title:h.Title,url:h.LinkToDetailPage,webcast:h.WebCastLink,financialReports:function(){if(h.EventFinancialReport[0]&&h.EventFinancialReport[0].Documents){var b=a.map(h.EventFinancialReport[0].Documents,function(a){return{docCategory:a.DocumentCategory,docSize:a.DocumentFileSize,docIcon:a.IconPath,docThumb:a.ThumbnailPath,docTitle:a.DocumentTitle,docType:a.DocumentFileType,docUrl:a.DocumentPath}});return{title:h.EventFinancialReport[0].ReportTitle,docs:b}}},tags:h.TagsList,clndrDateCls:b.element.className.indexOf("--selected")>-1?e[e.length-4]:e[e.length-3]})}),a(d.popupCls).html(Mustache.render(d.eventTemplates.event(),c)),void 0!==q4App&&void 0!==q4App.addToCalendar&&q4App.addToCalendar(d.popupCls+" .module_add-to-calendar"))},nextMonth:function(a){},previousMonth:function(a){},nextYear:function(a){},previousYear:function(a){},onMonthChange:function(b){var c=a(".module-event-calendar_event-container .module_item");c.length&&a(".module-event-calendar_day").filter("."+c.data("cls")).addClass("module-event-calendar_day--selected")},onYearChange:function(a){},today:function(a){}}}},_init:function(){this.callClndr(),a.extend(a.q4.calendar._proto.options,this.options)},publicEventParams:function(){var a=this.options;return{apiKey:a.apiKey,pageSize:a.eventSize,includeTags:!0,eventSelection:a.eventSelection,sortOperator:1,eventDateFilter:a.eventSelection,includePressReleases:a.news,includePresentations:a.presentations,includeFinancialReports:a.financials,tagList:a.tags.join("|"),LanguageId:a.languageId?a.languageId:GetLanguageId()}},privateEventParams:function(){var a=this.options;return{serviceDto:{ViewType:GetViewType(),ViewDate:GetViewDate(),Signature:GetSignature(),LanguageId:a.languageId?a.languageId:GetLanguageId(),RevisionNumber:GetRevisionNumber(),TagList:a.tags,StartIndex:0,ItemCount:a.eventSize,IncludeTags:!0},year:-1,eventSelection:a.eventSelection,sortOperator:1,includePressReleases:a.news,includePresentations:a.presentations,includeFinancialReports:a.financials}},getPrivateEventList:function(){var b=this;url=location.href.toLowerCase(),a.ajax({type:"POST",url:"/services/EventService.svc/GetEventList",data:JSON.stringify(b.privateEventParams()),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){b.buildEventObj(a.GetEventListResult)},error:function(){console.log("Events failed to load")}})},getPublicEventList:function(){var b=this;a.ajax({type:"GET",url:b.options.url+"/feed/Event.svc/GetEventList",data:b.publicEventParams(),dataType:"json",success:function(a){b.buildEventObj(a.GetEventListResult)},error:function(){console.log("Events failed to load")}})},buildEventObj:function(b){var c=this,d=[];a.each(b,function(a,b){var c=moment(b.StartDate).format("YYYY-MM-DD"),e=moment(b.EndDate).format("YYYY-MM-DD"),f={startDate:c,endDate:e,tag:b.TagsList.join(" "),items:b};d.push(f)}),c.calendar.addEvents(d),void 0!==this.options.onEventsLoad&&"function"==typeof this.options.onEventsLoad&&c.options.triggerEventsLoad&&this.options.onEventsLoad(c.calendar,d,c.options),c._trigger("complete")},getSlideShare:function(){var b=this;a.getJSON("//widgets.q4web.com/slideshare/rss/getRssByUser/"+b.options.slideshare+"?callback=?",function(a){b.parseSlideShare(a)})},parseSlideShare:function(b){var c=this,d=[];a.each(b,function(a,b){var c=moment(b.published).format("YYYY-MM-DD"),e={startDate:c,endDate:c,slideshare:!0,items:b};d.push(e)}),c.calendar.addEvents(d),void 0!==this.options.onSlideShareLoad&&"function"==typeof this.options.onSlideShareLoad&&this.options.onSlideShareLoad(c.calendar,d)},callClndr:function(){var a=this;a.calendar=a.element.clndr(a.options.calendar),a.options.usePublic?a.getPublicEventList():a.getPrivateEventList(),a.options.slideshare.length&&a.getSlideShare()},destroy:function(){this.element.html("")},_setOption:function(a,b){this._superApply(arguments)}})}(jQuery);